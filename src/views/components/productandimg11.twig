<pre>{{ row.product11|json_encode(constant('JSON_PRETTY_PRINT')) }}</pre>
<section class="s-block s-block--productandimg11" dir="rtl">
  {% set rows = section.settings.product111|default([]) %}

  <div class="container">
    <div class="grid grid-cols-1 gap-6">
      {% for row in rows %} {% set picked = attribute(row,
      'product11')|default([]) %} {# picked ممكن يبقى: - [1,2,3] (IDs) -
      [{id:1},{id:2}] (Objects) #} {% set ids = [] %} {% if picked is iterable
      %} {% for p in picked %} {% if p is iterable %} {% if attribute(p,'id') is
      not null %} {% set ids = ids|merge([attribute(p,'id')]) %} {% endif %} {%
      else %} {% set ids = ids|merge([p]) %} {% endif %} {% endfor %} {% endif
      %} {% set ids_str = ids|join(',') %}

      <div class="p-4 bg-white rounded-lg">
        {% if row.img %}
        <img
          src="{{ row.img }}"
          alt=""
          class="w-full h-auto rounded-md mb-4"
          loading="lazy"
        />
        {% endif %} {% if ids|length %}
        <salla-products ids="{{ ids_str }}">
          <template>
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
              <custom-salla-product-card
                class="shadow-on-hover"
                product="{{ product }}"
              ></custom-salla-product-card>
            </div>
          </template>
        </salla-products>
        {% else %}
        <p class="text-sm opacity-70">لم يتم اختيار منتجات.</p>
        {% endif %}
      </div>

      {% endfor %}
    </div>
  </div>
</section>

{% block styleproductandimg11 %}
<style>
  .s-block--productandimg11 {
    padding: 28px 0;
  }
</style>
{% endblock %}
